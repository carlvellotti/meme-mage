# Tech Specs: Step 2 - Prompt Engineering\n\n## Objective\n\nDefine a new prompt specifically tailored for the Gemini 2.5 Flash model to analyze a meme template video and an optional example caption, generating a structured explanation suitable for populating the `TemplateUploader` component.\n\n## Task\n\n1.  **Create New Prompt Function:**\n    *   Add a new exported function to the prompts utility file.\n    *   **File:** `src/lib/utils/prompts.ts`\n    *   **Function Name:** `getGeminiVideoAnalysisPrompt`\n    *   **Signature:** `(exampleCaption: string | null) => string`\n    *   **Implementation:**\n\n        ```typescript\n        // In src/lib/utils/prompts.ts\n\n        export const getGeminiVideoAnalysisPrompt = (exampleCaption: string | null) => `You are a meme template analyst. Based on the VIDEO provided and the EXAMPLE CAPTION below, create a detailed analysis of the meme template. Your analysis should help match user concepts with this template in the future.\n\n        EXAMPLE CAPTION: ${exampleCaption ? `\"${exampleCaption}\"` : \"No caption provided.\"}\n\n        Structure your analysis EXACTLY as follows using Markdown:\n\n        1.  **TRANSCRIPT:** (Optional) If the video has clear dialogue, transcribe relevant parts. If not applicable or difficult, state \"No clear transcript available.\"\n\n        2.  **VISUAL DESCRIPTION:**\n            *   Describe exactly what is happening visually (5 brief bullet points).\n            *   Mention character(s), setting, expressions, camera work.\n            *   Note key visual elements for recognition.\n            *   Describe the core moment/reaction.\n            *   Who/what is the main focus?\n\n        3.  **EMOTIONAL CONTEXT:**\n            *   Identify core emotions/feelings/situations conveyed (5 brief bullet points).\n            *   Describe the psychological state/reaction captured.\n            *   Note subtleties (irony, sincerity, exaggeration).\n            *   Explain the distinctiveness of this reaction.\n            *   Describe relationships/dynamics if applicable.\n\n        4.  **USAGE PATTERNS:**\n            *   List 5 typical situations/concepts where this template works well.\n            *   Identify concepts that pair naturally.\n            *   Explain scenarios where it\'s most effective.\n            *   Mention any common setup/punchline structures.\n            *   Who would use this meme and why?\n\n        5.  **EXAMPLE ANALYSIS:**\n            *   Restate the EXAMPLE CAPTION provided above.\n            *   Write a detailed 2-4 sentence explanation of *why this specific example caption works (or doesn\'t work)* with the provided VIDEO.\n            *   Analyze how the caption relates to the video\'s visual and emotional context.\n            *   Explain why the specific wording/concept is effective (or ineffective) for this template.\n            *   Connect the example to the unique elements identified in sections 2 & 3.\n\n        Focus on providing a deep understanding of the template\'s potential uses based *directly* on the video content and the single example caption provided. Be analytical and insightful. Ensure the output is valid Markdown.`;\n\n        // Keep the existing getTemplateAnalysisPrompt for the enhance-template API\n        export const getTemplateAnalysisPrompt = () => \`You are a meme template creator... [rest of existing prompt]\`; // Ensure this remains\n\n        // ... other existing prompts ...\n        ```\n\n## Rationale\n\n*   This prompt is specifically designed for the **video input** capability of Gemini 2.5 Flash.\n*   It explicitly requests analysis based on **both the video and the example caption** from the unprocessed template.\n*   The structured Markdown output is designed to be directly usable as the initial content for the `templateExplanation` field in the `TemplateUploader`.\n*   Keeping the existing `getTemplateAnalysisPrompt` separate allows the user to still use the AI enhancement feature within the `TemplateUploader` (which operates on text and optional pasted images) independently of this initial video analysis.\n\n## Outcome\n\n*   A new function `getGeminiVideoAnalysisPrompt` exists in `src/lib/utils/prompts.ts` containing the tailored prompt text.\n*   This function is ready to be imported and used by the backend API route in Step 3.\n 